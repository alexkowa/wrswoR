---
author:
  - name: Kirill Müller
    affiliation: IVT, ETH Zurich
    address: >
      Stefano-Franscini-Platz 9
      8093 Zürich
    email: kirill.mueller@ivt.baug.ethz.ch
    url: http://www.ivt.ethz.ch
title:
  formatted: "Accelerating weighted random sampling without replacement"
  # If you use tex in the formatted title, also supply version without
  plain:     "Accelerating weighted random sampling without replacement"
  # For running headers, if needed
  short:     "Accelerating weighted random sampling without replacement"
abstract: >
  The abstract of the article.
keywords:
  # at least one keyword must be supplied
  formatted: [keywords, not capitalized, "\\proglang{R}"]
  plain:     [keywords, not capitalized, R]
preamble: >
  \usepackage{amsmath}
  \usepackage[USenglish]{babel}
  \usepackage{algorithm}
  \usepackage{algorithmic}
  \usepackage[draft]{fixme}
  \usepackage[capitalize]{cleveref}
output: rticles::jss_article
---

# Introduction

Random sampling is one of the basic primitives in statistical computing.
\fxwarning{Used where?}

This paper focuses on a specific variant: sampling without replacement from a finite population
with nonuniform probability distribution.
\fxwarning{Application?}

First, different techniques for sampling from discrete populations are reviewed.
Several implementations for sampling without replacement are discussed,
this includes evaluation of correctness and runtime performance.
The paper concludes with suggestions for incorporating the findings into base
\proglang{R}.


# Sampling from discrete populations

We use \cref{alg:sample} as a definition of sampling from discrete populations
with or without replacement from arbitrary (including uniform) probability distributions:

\begin{algorithm}
  \caption{$\text{sample}(n, s, \text{replace}, p_i)$}
  \label{alg:sample}
  \begin{algorithmic}
    \REQUIRE $n$: Size of the population
    \REQUIRE $s$: Number of items to sample
    \REQUIRE $\text{replace}$: \TRUE{} to request sampling with replacement
    \REQUIRE $p_i$: Relative probability of each item for $i \in \{1,\ldots,n\}$
    \ENSURE Returns a vector $x_j \in \{1,\ldots,n\} $ with
      $j \in \{1,\ldots,s\}$ that contains the indexes of the items sampled
    \IF{$s = 0$}
      \RETURN vector of length 0
    \ENDIF
    \STATE Randomly select $k$ so that $\mathrm{P}(k=i) = \frac{p_k}{\sum_{j}p_j}$
      for all $i$
    \IF{not replace}
      \STATE $n \leftarrow n - 1$
      \STATE remove item $k$ from $p_i$
    \ENDIF
    \RETURN $k \oplus \text{sample}(n, s - 1, \text{replace}, p_i)$
  \end{algorithmic}
\end{algorithm}


## Framework

## With replacement

## Without replacement, uniform

## Without replacement, nonuniform



# Explanation of the code

# Code

# Examples

# From template

## Code formatting

Don't use markdown, instead use the more precise latex commands:

* \proglang{Java}
* \pkg{plyr}
* \code{print("abc")}

## R code

Can be inserted in regular R markdown blocks.

```{r}
x <- 1:10
x
```
